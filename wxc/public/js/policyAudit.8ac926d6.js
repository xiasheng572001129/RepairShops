(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["policyAudit"],{"088b":function(t,e,i){},"40c4":function(t,e,i){t.exports=i.p+"public/img/plate.a864be92.png"},"423e":function(t,e,i){t.exports=i.p+"public/img/policy.125bca72.png"},"8d8e":function(t,e,i){"use strict";var a=i("c4dd"),n=i.n(a);n.a},b430:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"member"},[a("div",{staticClass:"viewMain"},[a("div",{staticClass:"secondBody"},[a("el-table",{staticStyle:{"margin-top":"20px"},attrs:{data:t.tableData,"header-cell-style":{background:"#D7E1E6",color:"#32373C"}}},[a("el-table-column",{attrs:{prop:"plate",label:"车牌号",align:"center"}}),a("el-table-column",{attrs:{prop:"sale_time",label:"申请保养时间",align:"center"}}),a("el-table-column",{attrs:{prop:"company",label:"保险公司",align:"center"}}),a("el-table-column",{attrs:{prop:"policy_num",label:"保单号",align:"center"}}),a("el-table-column",{attrs:{prop:"start_time",label:"开始时间",align:"center"}}),a("el-table-column",{attrs:{prop:"end_time",label:"结束时间",align:"center"}}),a("el-table-column",{attrs:{prop:"policy_money",label:"保单金额",align:"center"}}),a("el-table-column",{attrs:{label:"投保类型",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover",content:e.row.policy_type.join(" 、")}},[a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("详情")])],1)]}}])}),a("el-table-column",{attrs:{label:"保单图片",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(i){t.policyImg(e.row.pc_img)}}},[t._v("详情")])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"small",loading:t.loading},on:{click:function(i){t.audit(e.row)}}},[t._v("审核")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(i){t.policyVisible=!0,t.Modify(e.row)}}},[t._v("修改保单")])]}}])})],1),a("el-dialog",{attrs:{title:"保单图片详情",center:"",width:"30%",visible:t.policyImgVisible},on:{"update:visible":function(e){t.policyImgVisible=e}}},[a("div",{ref:"policyImg",staticClass:"policyImgList"},t._l(t.policyImgList,function(t,e){return a("img",{key:e,attrs:{src:t}})}))]),a("el-dialog",{attrs:{title:"修改保单",center:"",visible:t.policyVisible},on:{"update:visible":function(e){t.policyVisible=e},close:function(){t.$refs.form.resetFields(),t.$refs.upload.clearFiles()}}},[a("el-form",{ref:"form",staticStyle:{width:"60%"},attrs:{model:t.policyData,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"客户类型: ",prop:"pid"}},[a("el-select",{staticClass:"el-Width",attrs:{placeholder:"请选择保险公司"},model:{value:t.policyData.pid,callback:function(e){t.$set(t.policyData,"pid",e)},expression:"policyData.pid"}},t._l(t.companyList,function(e,i){return a("el-option",{key:i,attrs:{label:e.company,value:e.id}},[t._v(t._s(e.company))])}))],1),a("el-form-item",{attrs:{label:"保单号: ",prop:"policy_num"}},[a("el-input",{staticClass:"el-Width",attrs:{placeholder:"请输入保单号"},model:{value:t.policyData.policy_num,callback:function(e){t.$set(t.policyData,"policy_num",e)},expression:"policyData.policy_num"}})],1),a("el-form-item",{attrs:{label:"投保金额: ",prop:"policy_money"}},[a("el-input",{staticClass:"el-Width",attrs:{placeholder:"请输入投保金额"},model:{value:t.policyData.policy_money,callback:function(e){t.$set(t.policyData,"policy_money",e)},expression:"policyData.policy_money"}})],1),a("el-form-item",{attrs:{label:"投保开始时间: ",prop:"start_time"}},[a("el-date-picker",{staticClass:"el-Width",attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择投保开始时间"},model:{value:t.policyData.start_time,callback:function(e){t.$set(t.policyData,"start_time",e)},expression:"policyData.start_time"}})],1),a("el-form-item",{attrs:{label:"投保结束时间: ",prop:"end_time"}},[a("el-date-picker",{staticClass:"el-Width",attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择投保结束时间"},model:{value:t.policyData.end_time,callback:function(e){t.$set(t.policyData,"end_time",e)},expression:"policyData.end_time"}})],1),a("el-form-item",{attrs:{label:"投保类型: ",prop:"policy_type"}},t._l(t.insuredType,function(e,i){return a("el-button",{key:i,staticClass:"insuredType",attrs:{type:e.checked?"primary":""},on:{click:function(e){t.chooseInsuredType(i)}}},[t._v(t._s(e.type))])})),a("el-form-item",{attrs:{label:"投保图片: ",prop:"pc_img"}},[a("el-upload",{ref:"upload",attrs:{action:t.uploadUrl,"list-type":"picture-card",limit:3,name:"image",data:{token:t.token},"file-list":t.fileList,"on-preview":t.handlePictureCardPreview,"on-success":t.handlePictureCardSuccess,"on-remove":t.handleRemove}},[a("i",{staticClass:"el-icon-plus"})]),a("el-dialog",{attrs:{visible:t.magnifyImgVisible,"append-to-body":""},on:{"update:visible":function(e){t.magnifyImgVisible=e}}},[a("img",{attrs:{width:"100%",src:t.magnifyImageUrl,alt:""}})]),a("div",{staticStyle:{color:"red"}},[t._v("上传说明: (含: 车前照、行驶证、保单照片、图片大小不能超过2M)")]),a("div",{staticStyle:{color:"red","line-height":"20px"}},[t._v("\n              1、不符合要求的车辆系统每单自动扣除维修厂120元\n            ")]),a("div",{staticStyle:{color:"red","line-height":"20px"}},[t._v("\n              2、保单信息确保清晰，一经上传，系统不可修改\n            ")]),a("div",{staticStyle:{color:"red",cursor:"pointer"},on:{click:function(e){t.instanceVisible=!0,t.examineShoot()}}},[t._v("查看拍摄实例(请上传清晰的保单图片)")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:t.uploadLoading},on:{click:t.upload}},[t._v("上传")])],1)],1),a("el-dialog",{attrs:{title:"示例",center:"",visible:t.instanceVisible,"append-to-body":""},on:{"update:visible":function(e){t.instanceVisible=e}}},[a("div",{staticClass:"instance"},[a("img",{ref:"license",attrs:{src:i("becb"),width:"200px",height:"200px"}}),a("img",{ref:"plate",attrs:{src:i("40c4"),width:"200px",height:"200px"}}),a("img",{ref:"policy",attrs:{src:i("423e"),width:"200px",height:"200px"}})])])],1),a("el-pagination",{staticClass:"page",attrs:{background:"",layout:"prev, pager, next","current-page":t.currentPage,"page-count":t.PageCount},on:{"current-change":t.getListData,"update:currentPage":function(e){t.currentPage=e}}})],1)])])},n=[],c=(i("20d6"),i("f751"),i("ac6a"),i("96cf"),i("1da1")),l=i("2fa4"),o=i.n(l),r=(i("0c97"),i("4362")),s={data:function(){return{sid:window.localStorage.getItem("sid"),token:window.localStorage.getItem("token"),keyword:"",currentPage:0,PageCount:1,tableData:[],total:"",policyImgVisible:!1,policyVisible:!1,policyImgList:[],loading:!1,policyData:{cid:"",sid:"",uid:"",pid:"",policy_num:"",policy_money:"",start_time:"",end_time:"",policy_type:[],pc_img:[]},insuredType:[],companyList:[],fileList:[],magnifyImgVisible:!1,magnifyImageUrl:"",instanceVisible:!1,uploadLoading:!1}},methods:{dataChange:function(){this.getListData()},getListData:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(r["Wb"])({sid:this.sid,page:this.currentPage});case 2:e=t.sent,1==e.data.code?(this.tableData=e.data.data.list,this.total=e.data.data.total,this.PageCount=e.data.data.rows):(this.tableData=[],this.PageCount=1,this.total=e.data.data.total,this.$message({message:e.data.msg,type:"warning"}));case 4:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),policyImg:function(t){var e=this;this.policyImgVisible=!0,this.policyImgList=t||[],this.$nextTick(function(){new o.a(e.$refs.policyImg)})},getCompany:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(r["h"])({sid:this.sid});case 3:e=t.sent,this.companyList=e.data.data||[],t.next=10;break;case 7:throw t.prev=7,t.t0=t["catch"](0),t.t0;case 10:case"end":return t.stop()}},t,this,[[0,7]])}));return function(){return t.apply(this,arguments)}}(),policyTypeList:function(){return new Promise(function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(e,i){var a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(r["Xb"])();case 3:a=t.sent,e(a.data.data||[]),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),i(t.t0);case 10:case"end":return t.stop()}},t,this,[[0,7]])}));return function(e,i){return t.apply(this,arguments)}}())},defaultPolicyType:function(){var t=this;try{this.policyTypeList().then(function(e){var i=e;i.forEach(function(e){t.policyData.policy_type.forEach(function(t){e=e.type==t?Object.assign(e,{checked:!0}):Object.assign(e,{checked:!1})})}),t.insuredType=i||[]})}catch(e){throw e}},chooseInsuredType:function(t){this.insuredType[t].checked=!this.insuredType[t].checked;var e=[];this.insuredType.filter(function(t){return t.checked}).forEach(function(t){e.push(t.type)}),this.policyData.policy_type=e},handlePictureCardPreview:function(t){this.magnifyImageUrl=t.url,this.magnifyImgVisible=!0},handlePictureCardSuccess:function(t){this.policyData.pc_img.push(t)},handleRemove:function(t){var e=this.policyData.pc_img.findIndex(function(e){return e==t.response});this.policyData.pc_img.splice(e,1)},examineShoot:function(){var t=this;this.$nextTick(function(){var e=t.$refs,i=e.license,a=e.plate,n=e.policy,c=[i,a,n];c.forEach(function(t){new o.a(t)})})},Modify:function(t){var e=this;console.log(t),this.$nextTick(function(){e.policyData=Object.assign({},t,{pid:t.company}),e.fileList=e.policyData.pc_img.map(function(t){return{url:t}}),e.defaultPolicyType()})},upload:function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,this.uploadLoading=!0,t.next=4,Object(r["wc"])(Object.assign({},this.policyData,{cid:this.policyData.id}));case 4:e=t.sent,this.uploadLoading=!1,1==e.data.code?(this.$message({message:e.data.msg,type:"success"}),this.policyVisible=!1,this.auditPolicyVisible=!1,this.getListData()):this.$message.error(e.data.msg),t.next=13;break;case 9:throw t.prev=9,t.t0=t["catch"](0),this.uploadLoading=!1,t.t0;case 13:case"end":return t.stop()}},t,this,[[0,9]])}));return function(){return t.apply(this,arguments)}}(),audit:function(t){var e=this;this.$confirm("此操作将审核保单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(c["a"])(regeneratorRuntime.mark(function i(){var a;return regeneratorRuntime.wrap(function(i){while(1)switch(i.prev=i.next){case 0:return i.prev=0,e.loading=!0,i.next=4,Object(r["A"])({sid:e.sid,uid:t.uid,cid:t.id});case 4:a=i.sent,e.loading=!1,1==a.data.code?(e.$message({message:a.data.msg,type:"success"}),e.getListData()):e.$message.error(a.data.msg),i.next=13;break;case 9:throw i.prev=9,i.t0=i["catch"](0),e.loading=!1,i.t0;case 13:case"end":return i.stop()}},i,this,[[0,9]])}))).catch(function(){})}},mounted:function(){this.getListData(),this.getCompany()}},p=s,u=(i("e1cd"),i("8d8e"),i("2877")),d=Object(u["a"])(p,a,n,!1,null,"6875d9f6",null);d.options.__file="policyAudit.vue";e["default"]=d.exports},becb:function(t,e,i){t.exports=i.p+"public/img/license.c861a0b4.png"},c4dd:function(t,e,i){},e1cd:function(t,e,i){"use strict";var a=i("088b"),n=i.n(a);n.a}}]);
//# sourceMappingURL=policyAudit.8ac926d6.js.map